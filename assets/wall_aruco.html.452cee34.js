import{_ as c,r as i,o as l,c as r,a as t,b as n,w as o,F as p,e as s,d as e}from"./app.4f6a4bec.js";const u={},h=s('<h1 id="navigation-using-vertical-aruco-markers" tabindex="-1"><a class="header-anchor" href="#navigation-using-vertical-aruco-markers" aria-hidden="true">#</a> Navigation using vertical ArUco-markers</h1><p>The algorithm of the navigation through visual ArUco-markers, that was implemented in the Clever image, supports the flexible configuration of the markers in area. It allows you to place them on any surface, at any angle.</p><h2 id="installing-the-vertical-camera-mount" tabindex="-1"><a class="header-anchor" href="#installing-the-vertical-camera-mount" aria-hidden="true">#</a> Installing the vertical camera mount</h2><p>For a better recognition of the markers, you need to set the camera vertically so that the lens is pointed parallel to the horizon.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>The configuration file allows you to configure the location of the camera in area relative to the copter in any way. For your convenience, we will review the option of installing the camera at an angle of 90 degrees to the horizon in the direction of the copter&#39;s nose.</p></div><h3 id="camera-mount-3d-printing" tabindex="-1"><a class="header-anchor" href="#camera-mount-3d-printing" aria-hidden="true">#</a> Camera mount, 3D printing</h3>',6),d=e("Print the "),m=e("camera mount"),g=e("."),k=s(`<p>Install the mount in a convenient location, so that the camera has a minimum number of unnecessary objects (protection, legs, propellers, beams) \u2014 all of it will negatively affect the recognition of the markers.</p><h2 id="setting-the-camera-transform" tabindex="-1"><a class="header-anchor" href="#setting-the-camera-transform" aria-hidden="true">#</a> Setting the camera transform</h2><p>To set the camera position at the desired angle, open the file <code>main_camera.launch</code>, located in <code>~/catkin_ws/src/clover/clover/launch/</code>.</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">nano</span> ~/catkin_ws/src/clover/clover/launch/main_camera.launch
</code></pre></div><p>In the parameters <code>direction_x</code>, <code>direction_y</code>, set empty values manually or enter the following lines:</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sed</span> -i <span class="token string">&quot;/direction_z/s/default=<span class="token entity" title="\\&quot;">\\&quot;</span>.*<span class="token entity" title="\\&quot;">\\&quot;</span>/default=<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token entity" title="\\&quot;">\\&quot;</span>/&quot;</span> /home/pi/catkin_ws/src/clover/clover/launch/main_camera.launch
<span class="token function">sed</span> -i <span class="token string">&quot;/direction_y/s/default=<span class="token entity" title="\\&quot;">\\&quot;</span>.*<span class="token entity" title="\\&quot;">\\&quot;</span>/default=<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token entity" title="\\&quot;">\\&quot;</span>/&quot;</span> /home/pi/catkin_ws/src/clover/clover/launch/main_camera.launch
</code></pre></div><p>Edit one of the configuration lines or add the line shown bellow:</p><div class="language-xml ext-xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node</span> <span class="token attr-name">pkg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tf2_ros<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>static_transform_publisher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main_camera_frame<span class="token punctuation">&quot;</span></span> <span class="token attr-name">args</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.05 0 0.05 -1.5707963 0 -1.5707963 base_link main_camera_optical<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><blockquote><p><strong>Note</strong>. Only one camera configuration can be used at a time. If you insert the line above, don&#39;t forget to comment the currently active one. The syntax highlighting system will help you determine that \u2014 the active line will be highlighted in a different color than the comments. To comment, add the <code>&lt;!--</code> and <code>--&gt;</code> symbols at the beginning and the end respectively.</p></blockquote>`,9),_=e("If you are using the marker map, where the markers have equal distances along the x and y axes, you can use "),f=e("script for creating markers map "),v=t("code",null,"gen_map.py",-1),y=e(". Otherwise, you will need to set them manually. To do this, go to the directory "),q=t("code",null,"map_name.txt",-1),x=e(" and create a map file. Fill out your map according to the "),b=e("map syntax"),w=e(". Here is an example of a marker map with a random marker location:"),T=s(`<blockquote><p><strong>Hint</strong>. When filling out the map, select one of the markers as the origin, and measure the distance to all other markers relative to it. If all your parameters are oriented same way, you can choose not to specify all 8 parameters, but only the first 5: the marker index, size, and its location in space along the x, y, and z axes, respectively.</p></blockquote><div class="language-text ext-text"><pre class="language-text"><code>106 0.33    0   0   0
103 0.33    1.53    0.23    0
153 0.40    -0.56   1.36    0
</code></pre></div><p>After you fill out the map, you need to apply it. To do it, edit the file <code>aruco.launch</code>, located in <code>~/catkin_ws/src/clover/clover/launch/</code>. Change the line <code>&lt;param name=&quot;map&quot; value=&quot;$(find aruco_pose)/map/map_name.txt&quot;/&gt;</code>, where <code>map_name.txt</code> is the name of your map file.</p><p>If you are using markers that are not linked to horizontal surfaces (floor, ceiling), you must disable the parameter <code>known_tilt</code> both in the module <code>aruco_detect</code> and <code>aruco_map</code> in the same file. To do it automatically, enter:</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sed</span> -i <span class="token string">&quot;/known_tilt/s/value=<span class="token entity" title="\\&quot;">\\&quot;</span>.*<span class="token entity" title="\\&quot;">\\&quot;</span>/value=<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token entity" title="\\&quot;">\\&quot;</span>/&quot;</span> /home/pi/catkin_ws/src/clover/clover/launch/aruco.launch
</code></pre></div><p>After all the settings, call <code>sudo systemctl restart clover</code> to restart the <code>clover</code> service.</p>`,6);function I(z,N){const a=i("RouterLink");return l(),r(p,null,[h,t("p",null,[d,n(a,{to:"/en/models.html#clover-3"},{default:o(()=>[m]),_:1}),g]),k,t("p",null,[_,n(a,{to:"/en/aruco_map.html#marker-map-definition"},{default:o(()=>[f,v]),_:1}),y,q,x,n(a,{to:"/en/aruco_map.html#marker-map-definition"},{default:o(()=>[b]),_:1}),w]),T],64)}var F=c(u,[["render",I],["__file","wall_aruco.html.vue"]]);export{F as default};
