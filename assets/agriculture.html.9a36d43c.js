import{_ as n,e as s}from"./app.4f6a4bec.js";import{_ as a,a as p}from"./field2.16b6105d.js";const t={},o=s(`<h1 id="recognition-of-crop-types-in-mass-agricultural-production" tabindex="-1"><a class="header-anchor" href="#recognition-of-crop-types-in-mass-agricultural-production" aria-hidden="true">#</a> Recognition of crop types in mass agricultural production</h1><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>Modern agriculture in many countries is becoming one of the shining examples of the rapid and successful introduction of new technologies. Unmanned aerial vehicles are capable of performing a wide range of tasks, among which monitoring of agricultural land has now become a common tool for increasing the efficiency of agriculture. The goal of my project is to write a code for recognizing crop types in mass agricultural production. In the future, from the recognition results, you can design a map of sown areas.</p><h2 id="monitoring" tabindex="-1"><a class="header-anchor" href="#monitoring" aria-hidden="true">#</a> Monitoring</h2><p>In agriculture, monitoring is necessary to obtain information on the state of land and crops. Based on the monitoring results, farmers or specialists can understand whether crops are sprouting normally, whether there is a threat from weeds and/or insects - pests, what is the degree of moisture in individual areas or entire areas, etc.</p><h2 id="explanation-of-the-code" tabindex="-1"><a class="header-anchor" href="#explanation-of-the-code" aria-hidden="true">#</a> Explanation of the code</h2><p>Import libraries:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> rospy
<span class="token keyword">import</span> cv2
<span class="token keyword">from</span> sensor_msgs<span class="token punctuation">.</span>msg <span class="token keyword">import</span> Image
<span class="token keyword">from</span> cv_bridge <span class="token keyword">import</span> CvBridge
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre></div><p>Create some variables:</p><div class="language-python ext-py"><pre class="language-python"><code>rospy<span class="token punctuation">.</span>init_node<span class="token punctuation">(</span><span class="token string">&#39;computer_vision_sample&#39;</span><span class="token punctuation">)</span>

bridge <span class="token operator">=</span> CvBridge<span class="token punctuation">(</span><span class="token punctuation">)</span>

color <span class="token operator">=</span> <span class="token string">&#39;undefined&#39;</span>
shape <span class="token operator">=</span> <span class="token string">&#39;undefined&#39;</span>
culture <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
</code></pre></div><p>To implement computer vision algorithms, it is recommended to use the OpenCV library preinstalled on the Clover image. Create a subscriber for the topic with the image from the main camera for processing using OpenCV:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">image_colback_color</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> color<span class="token punctuation">,</span> shape

    cv_image <span class="token operator">=</span> bridge<span class="token punctuation">.</span>imgmsg_to_cv2<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&#39;bgr8&#39;</span><span class="token punctuation">)</span> <span class="token comment"># OpenCV image</span>
    img_hsv <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>cv_image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2HSV<span class="token punctuation">)</span> <span class="token comment">#[118:119,158:159]</span>

    <span class="token comment">#detected color</span>
    <span class="token comment">#print(img_hsv[0][0])</span>
</code></pre></div><p>Each culture has its unique shade (wheat is golden, buckwheat is light brown).</p><img src="`+a+'" width="75%"><img src="'+p+`" width="75%"><p>We describe color ranges for certain crops:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#wheat</span>
yellow_orange_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
yellow_orange_high<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>

<span class="token comment">#buckwheat</span>
brown_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
brown_high<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>

yellow_orange_mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>img_hsv<span class="token punctuation">,</span> yellow_orange_low<span class="token punctuation">,</span> yellow_orange_high<span class="token punctuation">)</span>
brown_mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>img_hsv<span class="token punctuation">,</span> brown_low<span class="token punctuation">,</span> brown_high<span class="token punctuation">)</span>

<span class="token keyword">if</span> yellow_orange_mask<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">159</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">:</span>
    shape <span class="token operator">=</span> shape_recog<span class="token punctuation">(</span>yellow_orange_mask<span class="token punctuation">)</span>

<span class="token keyword">elif</span> brown_mask<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">159</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">:</span>
    shape <span class="token operator">=</span> shape_recog<span class="token punctuation">(</span>brown_mask<span class="token punctuation">)</span>

<span class="token keyword">else</span><span class="token punctuation">:</span>
    shape <span class="token operator">=</span> <span class="token string">&#39;undefined&#39;</span>
    color <span class="token operator">=</span> <span class="token string">&#39;undefined&#39;</span>

<span class="token keyword">if</span> shape <span class="token operator">==</span> <span class="token string">&#39;brown&#39;</span><span class="token punctuation">:</span>
    culture <span class="token operator">=</span> <span class="token string">&quot;greshiha&quot;</span>
<span class="token keyword">if</span> shape <span class="token operator">==</span> <span class="token string">&#39;yellow_orange&#39;</span><span class="token punctuation">:</span>
    culture <span class="token operator">=</span> <span class="token string">&quot;pshenitsa&quot;</span>

image_sub <span class="token operator">=</span> rospy<span class="token punctuation">.</span>Subscriber<span class="token punctuation">(</span><span class="token string">&#39;main_camera/image_raw&#39;</span><span class="token punctuation">,</span> Image<span class="token punctuation">,</span> image_colback_color<span class="token punctuation">)</span>
</code></pre></div><p>The script will take up to 100% CPU capacity. To slow down the script artificially, you can use throttling of frames from the camera, for example, at 5 Hz (<code>main_camera.launch</code>):</p><div class="language-xml ext-xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node</span> <span class="token attr-name">pkg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>topic_tools<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cam_throttle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>throttle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">args</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messages main_camera/image_raw 5.0 main_camera/image_raw_throttled<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>The topic for the subscriber, in this case, should be changed for <code>main_camera/image_raw_throttled</code>.</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">print</span> <span class="token punctuation">(</span>culture<span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token keyword">not</span> rospy<span class="token punctuation">.</span>is_shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;color: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;shape: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
    rospy<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre></div><p>This program will recognize the culture by its shade. We can use more color ranges to improve the accuracy of the recognition so the drone can recognize more crops.</p><p>Examples of color ranges for other colors:</p><div class="language-python ext-py"><pre class="language-python"><code>red_low1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
red_high1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

red_low2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
red_high2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

red_orange_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
red_orange_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>

orange_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
orange_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>

yellow_orange_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
yellow_orange_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>

yellow_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
yellow_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

yellow_green_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
yellow_green_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

green_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
green_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

blue_green_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
blue_green_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

blue_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
blue_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

blue_violet_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
blue_violet_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

violet_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
violet_high <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>

red_violet_low <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
red_violet_hugh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
</code></pre></div><p>Note that there are two ranges for red because red is at the edges of the HSV color space.</p>`,25);function e(c,u){return o}var i=n(t,[["render",e],["__file","agriculture.html.vue"]]);export{i as default};
