<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Autonomous Multirotor Landing System (AMLS) | Клевер</title><meta name="description" content="Конструктор квадрокоптера «Клевер»">
    <link rel="modulepreload" href="/clover-vuepress/assets/app.4f6a4bec.js"><link rel="modulepreload" href="/clover-vuepress/assets/amls.html.c8e6ecd7.js"><link rel="modulepreload" href="/clover-vuepress/assets/amls.html.5b2a75a1.js"><link rel="modulepreload" href="/clover-vuepress/assets/follow_the_white_rabbit.302de01b.js">
    <link rel="stylesheet" href="/clover-vuepress/assets/style.7a1025bf.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="true" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/clover-vuepress/ru/" class=""><img class="logo" src="/clover-vuepress/clover-logo.png" alt="Клевер"><span class="site-name can-hide">Клевер</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://coex.tech" rel="noopener noreferrer" target="_blank" aria-label="Сайт"><!--[--><!--]--> Сайт <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://t.me/COEXHelpdesk" rel="noopener noreferrer" target="_blank" aria-label="Чат поддержки"><!--[--><!--]--> Чат поддержки <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/clover-vuepress/en/amls.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/clover-vuepress/ru/amls.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Русский"><!--[--><!--]--> Русский <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/CopterExpress/clover" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="Переключить темную тему"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://coex.tech" rel="noopener noreferrer" target="_blank" aria-label="Сайт"><!--[--><!--]--> Сайт <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://t.me/COEXHelpdesk" rel="noopener noreferrer" target="_blank" aria-label="Чат поддержки"><!--[--><!--]--> Чат поддержки <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/clover-vuepress/en/amls.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/clover-vuepress/ru/amls.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Русский"><!--[--><!--]--> Русский <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/CopterExpress/clover" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/clover-vuepress/ru/" class="sidebar-item sidebar-heading" aria-label="Клевер"><!--[--><!--]--> Клевер <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/glossary.html" class="sidebar-item sidebar-heading" aria-label="Глоссарий"><!--[--><!--]--> Глоссарий <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/safety.html" class="sidebar-item sidebar-heading" aria-label="Инструкция по безопасности"><!--[--><!--]--> Инструкция по безопасности <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Сборка <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/assembly.html" class="sidebar-item" aria-label="Сборка Клевера"><!--[--><!--]--> Сборка Клевера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_4_2_pro.html" class="sidebar-item" aria-label="Сборка Клевера 4.2 Pro"><!--[--><!--]--> Сборка Клевера 4.2 Pro <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_4_2.html" class="sidebar-item" aria-label="Сборка Клевера 4.2"><!--[--><!--]--> Сборка Клевера 4.2 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_4_2_ws.html" class="sidebar-item" aria-label="Сборка Клевера 4.2 WorldSkills"><!--[--><!--]--> Сборка Клевера 4.2 WorldSkills <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_4_1.html" class="sidebar-item" aria-label="Сборка Клевера 4.1"><!--[--><!--]--> Сборка Клевера 4.1 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_4.html" class="sidebar-item" aria-label="Сборка Клевера 4"><!--[--><!--]--> Сборка Клевера 4 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_3.html" class="sidebar-item" aria-label="Сборка Клевера 3"><!--[--><!--]--> Сборка Клевера 3 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/assemble_2.html" class="sidebar-item" aria-label="Инструкция по сборке конструктора Клевер 2"><!--[--><!--]--> Инструкция по сборке конструктора Клевер 2 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Настройка <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/setup.html" class="sidebar-item" aria-label="Первоначальная настройка"><!--[--><!--]--> Первоначальная настройка <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/calibration.html" class="sidebar-item" aria-label="Калибровка датчиков"><!--[--><!--]--> Калибровка датчиков <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/radio.html" class="sidebar-item" aria-label="Настройка пульта"><!--[--><!--]--> Настройка пульта <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/rc_flysky_a8s.html" class="sidebar-item" aria-label="Работа с приёмником Flysky FS-A8S"><!--[--><!--]--> Работа с приёмником Flysky FS-A8S <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/modes.html" class="sidebar-item" aria-label="Полетные режимы"><!--[--><!--]--> Полетные режимы <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/power.html" class="sidebar-item" aria-label="Настройка питания"><!--[--><!--]--> Настройка питания <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/failsafe.html" class="sidebar-item" aria-label="Настройка Failsafe"><!--[--><!--]--> Настройка Failsafe <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Ручной полет <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/flight.html" class="sidebar-item" aria-label="Полет"><!--[--><!--]--> Полет <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/flight_exercises.html" class="sidebar-item" aria-label="Упражнения для управления коптером"><!--[--><!--]--> Упражнения для управления коптером <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Работа с Raspberry Pi <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/raspberry.html" class="sidebar-item" aria-label="Raspberry Pi"><!--[--><!--]--> Raspberry Pi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/image.html" class="sidebar-item" aria-label="Образ для Raspberry Pi"><!--[--><!--]--> Образ для Raspberry Pi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/wifi.html" class="sidebar-item" aria-label="Подключение к Клеверу по Wi-Fi"><!--[--><!--]--> Подключение к Клеверу по Wi-Fi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/connection.html" class="sidebar-item" aria-label="Подключение Raspberry Pi к полетному контроллеру"><!--[--><!--]--> Подключение Raspberry Pi к полетному контроллеру <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/gcs_bridge.html" class="sidebar-item" aria-label="Подключение QGroundControl по Wi-Fi"><!--[--><!--]--> Подключение QGroundControl по Wi-Fi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/ssh.html" class="sidebar-item" aria-label="Доступ по SSH к Raspberry Pi"><!--[--><!--]--> Доступ по SSH к Raspberry Pi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/cli.html" class="sidebar-item" aria-label="Командная строка"><!--[--><!--]--> Командная строка <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/selfcheck.html" class="sidebar-item" aria-label="Автоматическая проверка"><!--[--><!--]--> Автоматическая проверка <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/web_video_server.html" class="sidebar-item" aria-label="Просмотр изображений с камер"><!--[--><!--]--> Просмотр изображений с камер <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Программирование <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/programming.html" class="sidebar-item" aria-label="Программирование"><!--[--><!--]--> Программирование <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/camera_setup.html" class="sidebar-item" aria-label="Настройка камеры"><!--[--><!--]--> Настройка камеры <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/aruco.html" class="sidebar-item" aria-label="ArUco-маркеры"><!--[--><!--]--> ArUco-маркеры <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/aruco_marker.html" class="sidebar-item" aria-label="Распознавание ArUco-маркеров"><!--[--><!--]--> Распознавание ArUco-маркеров <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/aruco_map.html" class="sidebar-item" aria-label="Навигация по картам ArUco-маркеров"><!--[--><!--]--> Навигация по картам ArUco-маркеров <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/optical_flow.html" class="sidebar-item" aria-label="Использование Optical Flow"><!--[--><!--]--> Использование Optical Flow <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simple_offboard.html" class="sidebar-item" aria-label="Автономный полет"><!--[--><!--]--> Автономный полет <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/frames.html" class="sidebar-item" aria-label="Системы координат (фреймы)"><!--[--><!--]--> Системы координат (фреймы) <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/snippets.html" class="sidebar-item" aria-label="Примеры кода"><!--[--><!--]--> Примеры кода <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/laser.html" class="sidebar-item" aria-label="Работа с лазерным дальномером"><!--[--><!--]--> Работа с лазерным дальномером <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/leds.html" class="sidebar-item" aria-label="Работа со светодиодной лентой"><!--[--><!--]--> Работа со светодиодной лентой <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/gpio.html" class="sidebar-item" aria-label="Работа с GPIO"><!--[--><!--]--> Работа с GPIO <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/sonar.html" class="sidebar-item" aria-label="Работа с ультразвуковым дальномером"><!--[--><!--]--> Работа с ультразвуковым дальномером <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/camera.html" class="sidebar-item" aria-label="Работа с камерой"><!--[--><!--]--> Работа с камерой <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/rviz.html" class="sidebar-item" aria-label="Использование rviz и rqt"><!--[--><!--]--> Использование rviz и rqt <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/autolaunch.html" class="sidebar-item" aria-label="Автозапуск ПО"><!--[--><!--]--> Автозапуск ПО <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/javascript.html" class="sidebar-item" aria-label="Работа с ROS из браузера"><!--[--><!--]--> Работа с ROS из браузера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/blocks.html" class="sidebar-item" aria-label="Блочное программирование Клевера"><!--[--><!--]--> Блочное программирование Клевера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simulation.html" class="sidebar-item" aria-label="Симулятор"><!--[--><!--]--> Симулятор <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simulation_native.html" class="sidebar-item" aria-label="Сборка на собственной машине"><!--[--><!--]--> Сборка на собственной машине <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simulation_vm.html" class="sidebar-item" aria-label="Установка виртуальной машины"><!--[--><!--]--> Установка виртуальной машины <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simulation_usage.html" class="sidebar-item" aria-label="Использование симулятора"><!--[--><!--]--> Использование симулятора <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/simulation_m1.html" class="sidebar-item" aria-label="Симулятор на компьютерах с чипом M1"><!--[--><!--]--> Симулятор на компьютерах с чипом M1 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/ros.html" class="sidebar-item" aria-label="ROS"><!--[--><!--]--> ROS <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/mavros.html" class="sidebar-item" aria-label="MAVROS"><!--[--><!--]--> MAVROS <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Дополнительно <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/supplementary.html" class="sidebar-item" aria-label="Дополнительные материалы"><!--[--><!--]--> Дополнительные материалы <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/coex_pix.html" class="sidebar-item" aria-label="COEX Pix"><!--[--><!--]--> COEX Pix <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/coex_pdb.html" class="sidebar-item" aria-label="COEX PDB"><!--[--><!--]--> COEX PDB <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/coex_gps.html" class="sidebar-item" aria-label="COEX GPS"><!--[--><!--]--> COEX GPS <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/radio_telemetry.html" class="sidebar-item" aria-label="Использование радиотелеметрии"><!--[--><!--]--> Использование радиотелеметрии <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/hawk_eye.html" class="sidebar-item" aria-label="Камера Hawk Eye"><!--[--><!--]--> Камера Hawk Eye <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/auto_setup.html" class="sidebar-item" aria-label="Пошаговая инструкция по настройке автономного полета Клевера 4"><!--[--><!--]--> Пошаговая инструкция по настройке автономного полета Клевера 4 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/hostname.html" class="sidebar-item" aria-label="Имя хоста"><!--[--><!--]--> Имя хоста <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/sitl.html" class="sidebar-item" aria-label="Симуляция PX4"><!--[--><!--]--> Симуляция PX4 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/pid_tuning.html" class="sidebar-item" aria-label="Настройка PID регуляторов"><!--[--><!--]--> Настройка PID регуляторов <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/wall_aruco.html" class="sidebar-item" aria-label="Навигация по вертикальным ArUco-маркерам"><!--[--><!--]--> Навигация по вертикальным ArUco-маркерам <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/models.html" class="sidebar-item" aria-label="CAD-модели"><!--[--><!--]--> CAD-модели <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/sitl_docker.html" class="sidebar-item" aria-label="Docker-контейнер с преднастроенным SITL"><!--[--><!--]--> Docker-контейнер с преднастроенным SITL <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/ros-install.html" class="sidebar-item" aria-label="Установка и настройка пакета ROS Melodic"><!--[--><!--]--> Установка и настройка пакета ROS Melodic <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/camera_calibration.html" class="sidebar-item" aria-label="Калибровка камеры"><!--[--><!--]--> Калибровка камеры <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/zerotire_vpn.html" class="sidebar-item" aria-label="Создание виртуальной сети ZeroTire и подключение к ней"><!--[--><!--]--> Создание виртуальной сети ZeroTire и подключение к ней <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/hamachi_vpn.html" class="sidebar-item" aria-label="Быстрое подключение к виртуальной сети"><!--[--><!--]--> Быстрое подключение к виртуальной сети <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/4g.html" class="sidebar-item" aria-label="Управление при помощи 4G связи"><!--[--><!--]--> Управление при помощи 4G связи <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/jetson_nano.html" class="sidebar-item" aria-label="Пакеты Клевера на Jetson Nano"><!--[--><!--]--> Пакеты Клевера на Jetson Nano <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/rc.html" class="sidebar-item" aria-label="Управление Клевером со смартфона"><!--[--><!--]--> Управление Клевером со смартфона <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/network.html" class="sidebar-item" aria-label="Настройка Wi-Fi"><!--[--><!--]--> Настройка Wi-Fi <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/uart.html" class="sidebar-item" aria-label="Интерфейс UART"><!--[--><!--]--> Интерфейс UART <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/parameters.html" class="sidebar-item" aria-label="Параметры PX4"><!--[--><!--]--> Параметры PX4 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/flight_logs.html" class="sidebar-item" aria-label="Логи и топики PX4"><!--[--><!--]--> Логи и топики PX4 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/firmware.html" class="sidebar-item" aria-label="Прошивка полетного контроллера"><!--[--><!--]--> Прошивка полетного контроллера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/mavlink.html" class="sidebar-item" aria-label="MAVLink"><!--[--><!--]--> MAVLink <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/test_connection.html" class="sidebar-item" aria-label="Использование мультиметра"><!--[--><!--]--> Использование мультиметра <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/radioerrors.html" class="sidebar-item" aria-label="Неисправности радиоаппаратуры"><!--[--><!--]--> Неисправности радиоаппаратуры <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/esc_firmware.html" class="sidebar-item" aria-label="Прошивка ESC регуляторов с помощью BLHeliSuite"><!--[--><!--]--> Прошивка ESC регуляторов с помощью BLHeliSuite <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/arduino.html" class="sidebar-item" aria-label="Управление коптером с Arduino"><!--[--><!--]--> Управление коптером с Arduino <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/gps.html" class="sidebar-item" aria-label="Подключение GPS"><!--[--><!--]--> Подключение GPS <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/ir_sensors.html" class="sidebar-item" aria-label="Работа с ИК-датчиками на Raspberry Pi 3"><!--[--><!--]--> Работа с ИК-датчиками на Raspberry Pi 3 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/fpv_clover_4_2.html" class="sidebar-item" aria-label="Установка и настройка FPV-оборудования"><!--[--><!--]--> Установка и настройка FPV-оборудования <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/fpv.html" class="sidebar-item" aria-label="Установка FPV"><!--[--><!--]--> Установка FPV <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/magnetic_grip.html" class="sidebar-item" aria-label="Сборка и настройка электромагнитного захвата"><!--[--><!--]--> Сборка и настройка электромагнитного захвата <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/mechanical_grip.html" class="sidebar-item" aria-label="Сборка и настройка механического захвата"><!--[--><!--]--> Сборка и настройка механического захвата <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/magnetic_grip_load.html" class="sidebar-item" aria-label="Груз с подставкой для магнитного захвата"><!--[--><!--]--> Груз с подставкой для магнитного захвата <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/sphere_guard.html" class="sidebar-item" aria-label="Сборка сферической защиты"><!--[--><!--]--> Сборка сферической защиты <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/trainer_mode.html" class="sidebar-item" aria-label="Настройка режима тренера на пульте FlySky"><!--[--><!--]--> Настройка режима тренера на пульте FlySky <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/tinning.html" class="sidebar-item" aria-label="Лужение"><!--[--><!--]--> Лужение <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/px4flow.html" class="sidebar-item" aria-label="Смарт-камера PX4FLOW"><!--[--><!--]--> Смарт-камера PX4FLOW <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/connectortypes.html" class="sidebar-item" aria-label="Типы силовых разъемов"><!--[--><!--]--> Типы силовых разъемов <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/esp8266_bridge.html" class="sidebar-item" aria-label="Модуль ESP8266"><!--[--><!--]--> Модуль ESP8266 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/image_building.html" class="sidebar-item" aria-label="Автоматическая сборка и модификация образа Клевера"><!--[--><!--]--> Автоматическая сборка и модификация образа Клевера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/4in1.html" class="sidebar-item" aria-label="Подключение регуляторов 4in1"><!--[--><!--]--> Подключение регуляторов 4in1 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/leds_old.html" class="sidebar-item" aria-label="Работа со светодиодной лентой на Raspberry 3"><!--[--><!--]--> Работа со светодиодной лентой на Raspberry 3 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/contributing.html" class="sidebar-item" aria-label="Вклад в Клевер"><!--[--><!--]--> Вклад в Клевер <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/packages.html" class="sidebar-item" aria-label="Репозиторий пакетов COEX"><!--[--><!--]--> Репозиторий пакетов COEX <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/testing.html" class="sidebar-item" aria-label="Список тестирования"><!--[--><!--]--> Список тестирования <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/migrate20.html" class="sidebar-item" aria-label="Переход на версию 0.20"><!--[--><!--]--> Переход на версию 0.20 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/migrate22.html" class="sidebar-item" aria-label="Переход на версию 0.22"><!--[--><!--]--> Переход на версию 0.22 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/duocam.html" class="sidebar-item" aria-label="COEX DuoCam"><!--[--><!--]--> COEX DuoCam <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/duocam_mavlink.html" class="sidebar-item" aria-label="Виртуальная MAVLink-камера COEX DuoCam"><!--[--><!--]--> Виртуальная MAVLink-камера COEX DuoCam <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/duocam_setup.html" class="sidebar-item" aria-label="Настройка и трансляция изображения с DuoCam"><!--[--><!--]--> Настройка и трансляция изображения с DuoCam <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Мероприятия <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/events.html" class="sidebar-item" aria-label="Мероприятия"><!--[--><!--]--> Мероприятия <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/copterhack2022.html" class="sidebar-item" aria-label="CopterHack 2022"><!--[--><!--]--> CopterHack 2022 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/copterhack2021.html" class="sidebar-item" aria-label="CopterHack 2021"><!--[--><!--]--> CopterHack 2021 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/copterhack2019.html" class="sidebar-item" aria-label="Copter Hack 2019"><!--[--><!--]--> Copter Hack 2019 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/nti2019.html" class="sidebar-item" aria-label="Олимпиада НТИ 2019"><!--[--><!--]--> Олимпиада НТИ 2019 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/robocross2019.html" class="sidebar-item" aria-label="Робокросс-2019"><!--[--><!--]--> Робокросс-2019 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/copterhack2018.html" class="sidebar-item" aria-label="Copter Hack 2018"><!--[--><!--]--> Copter Hack 2018 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/copterhack2017.html" class="sidebar-item" aria-label="Copter Hack 2017"><!--[--><!--]--> Copter Hack 2017 <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/video_contest.html" class="sidebar-item" aria-label="Конкурс на лучшее образовательное видео по сборке и настройке"><!--[--><!--]--> Конкурс на лучшее образовательное видео по сборке и настройке <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/educational_contests.html" class="sidebar-item" aria-label="Образовательные конкурсы"><!--[--><!--]--> Образовательные конкурсы <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Проекты <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/clover-vuepress/ru/projects.html" class="sidebar-item" aria-label="Проекты на базе Клевера"><!--[--><!--]--> Проекты на базе Клевера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/lane_control.html" class="sidebar-item" aria-label="Контроль соблюдения ПДД на выделенной полосе с дроном"><!--[--><!--]--> Контроль соблюдения ПДД на выделенной полосе с дроном <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/clover-vuepress/ru/amls.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Autonomous Multirotor Landing System (AMLS)"><!--[--><!--]--> Autonomous Multirotor Landing System (AMLS) <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/remote-control-with-oculusvr.html" class="sidebar-item" aria-label="Разработка системы для управления БПЛА с помощью шлема виртуальной реальности"><!--[--><!--]--> Разработка системы для управления БПЛА с помощью шлема виртуальной реальности <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/clever-show.html" class="sidebar-item" aria-label="clever-show"><!--[--><!--]--> clever-show <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/innopolis_open_L22_AERO.html" class="sidebar-item" aria-label="Innopolis Open 2020 - команда L22_ÆRO"><!--[--><!--]--> Innopolis Open 2020 - команда L22_ÆRO <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/nti2020_p4df2.html" class="sidebar-item" aria-label="Олимпиада НТИ 2020 – Летательная робототехника (P4DF2)"><!--[--><!--]--> Олимпиада НТИ 2020 – Летательная робототехника (P4DF2) <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/arucogenmap.html" class="sidebar-item" aria-label="Генератор ArUco карт"><!--[--><!--]--> Генератор ArUco карт <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/bigchallenges.html" class="sidebar-item" aria-label="Аэротакси"><!--[--><!--]--> Аэротакси <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/shield.html" class="sidebar-item" aria-label="Шаровая защита коптера"><!--[--><!--]--> Шаровая защита коптера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/race_timing_sys_copterhack.html" class="sidebar-item" aria-label="Система засечки (хронометража) для дронов"><!--[--><!--]--> Система засечки (хронометража) для дронов <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/3dscan.html" class="sidebar-item" aria-label="Дрон для 3D-сканирования человека"><!--[--><!--]--> Дрон для 3D-сканирования человека <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/face_recognition.html" class="sidebar-item" aria-label="Система распознавания лиц"><!--[--><!--]--> Система распознавания лиц <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/control_emotions.html" class="sidebar-item" aria-label="Управление дроном силой мысли"><!--[--><!--]--> Управление дроном силой мысли <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/object_counting.html" class="sidebar-item" aria-label="Система распознавания и подсчета количества объектов"><!--[--><!--]--> Система распознавания и подсчета количества объектов <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/android.html" class="sidebar-item" aria-label="Пульт на Android"><!--[--><!--]--> Пульт на Android <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/clever_blocks.html" class="sidebar-item" aria-label="Блочное программирование Клевера"><!--[--><!--]--> Блочное программирование Клевера <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/camera_calib.html" class="sidebar-item" aria-label="Калибровка камеры"><!--[--><!--]--> Калибровка камеры <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/human_pose_estimation_drone_control.html" class="sidebar-item" aria-label="Управление дроном при помощи позы человека"><!--[--><!--]--> Управление дроном при помощи позы человека <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/agriculture.html" class="sidebar-item" aria-label="Распознавание видов агрокультур в массовом сельском производстве"><!--[--><!--]--> Распознавание видов агрокультур в массовом сельском производстве <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/advanced_clover.html" class="sidebar-item" aria-label="Advanced Clover"><!--[--><!--]--> Advanced Clover <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/seeding_drone.html" class="sidebar-item" aria-label="Дрон для высаживания семян"><!--[--><!--]--> Дрон для высаживания семян <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/ddrone.html" class="sidebar-item" aria-label="Граффити коптер D-drone"><!--[--><!--]--> Граффити коптер D-drone <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/zaural_viking.html" class="sidebar-item" aria-label="Программируемый летающий автомобиль"><!--[--><!--]--> Программируемый летающий автомобиль <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/drone-agronom.html" class="sidebar-item" aria-label="Дрон-Агроном"><!--[--><!--]--> Дрон-Агроном <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/easytofly.html" class="sidebar-item" aria-label="EasyToFly"><!--[--><!--]--> EasyToFly <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/hardaton_quidditch.html" class="sidebar-item" aria-label="Хардатон Квиддич"><!--[--><!--]--> Хардатон Квиддич <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/oktazodg.html" class="sidebar-item" aria-label="Октокоптер со специфичным расположением пропеллеров"><!--[--><!--]--> Октокоптер со специфичным расположением пропеллеров <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/clover-vuepress/ru/lessons.html" class="sidebar-item sidebar-heading" aria-label="Теория"><!--[--><!--]--> Теория <!--[--><!--]--></a><!----></li><li><a href="/clover-vuepress/ru/metod.html" class="sidebar-item sidebar-heading" aria-label="Методические материалы"><!--[--><!--]--> Методические материалы <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="autonomous-multirotor-landing-system-amls" tabindex="-1"><a class="header-anchor" href="#autonomous-multirotor-landing-system-amls" aria-hidden="true">#</a> Autonomous Multirotor Landing System (AMLS)</h1><p><img src="/clover-vuepress/assets/logo_book.9d456bb4.png" alt="Logo" title="Logo"></p><h2 id="цель-проекта-автоматически-посадить-дрон-в-движении" tabindex="-1"><a class="header-anchor" href="#цель-проекта-автоматически-посадить-дрон-в-движении" aria-hidden="true">#</a> Цель проекта: Автоматически посадить дрон в движении</h2><h3 id="статья-о-проекте-amls" tabindex="-1"><a class="header-anchor" href="#статья-о-проекте-amls" aria-hidden="true">#</a> Статья о проекте AMLS</h3><p>В этой статье будет описание нашего проекта, а именно, алгоритмов оптической стабилизации, удержания по GPS, следование по GPS, удержания высоты, системы захватов, крыши, измерения освещённости, скорости движения платформы. Также, после прочтения статьи станет понятно, как работает проект AMLS!</p><h3 id="основнои-репозитории-проекта-на-github" tabindex="-1"><a class="header-anchor" href="#основнои-репозитории-проекта-на-github" aria-hidden="true">#</a> Основной репозиторий проекта на GitHub</h3><p><a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Liberty-Way<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="разработчики" tabindex="-1"><a class="header-anchor" href="#разработчики" aria-hidden="true">#</a> Разработчики</h3><ul><li><a href="mailto:xxoinvizionxx@gmail.com">Павел Нешумов</a></li><li><a href="mailto:astik452@gmail.com">Андрей Кабалин</a></li><li><a href="mailto:vlad.yasn@gmail.com">Владислав Яснецкий</a></li></ul><p><img src="/clover-vuepress/assets/drone_meme.cbae0c34.jpg" alt="Drone 1" title="Drone 1"></p><hr><h2 id="оглавление" tabindex="-1"><a class="header-anchor" href="#оглавление" aria-hidden="true">#</a> Оглавление</h2><ul><li><a href="#how-it-works">0. Как это работает?</a><ul><li><a href="#short-video-about-our-project-clickable">0.1. Видео про наш проект</a></li></ul></li><li><a href="#hold-and-flight-to-waypoints-functions">1. Удержание по GPS и полёт по точкам</a><ul><li><a href="#serial-reading">1.1. Чтение данных из UART</a></li><li><a href="#ublox-parsing">1.2. Парсинг протокола UBlox</a></li><li><a href="#set-current-waypoint">1.3. Установка текущей путевой точки</a></li><li><a href="#waypoint-edit-to-fly-to-waypoints">1.4. Изменение точек (Чтобы летать по координатам)</a></li><li><a href="#waypoint-stabilization">1.5. Удержание конкретной позиции</a></li></ul></li><li><a href="#following">2. Следование за платформой</a></li><li><a href="#compass">3. Компас</a></li><li><a href="#altitude-stabilization-barometer">4. Удержание высоты (барометр)</a></li><li><a href="#optical-stabilization">5. Оптическая стабилизация</a><ul><li><a href="#so-difficult-and-so-important">5.1. Так сложно и так важно</a></li><li><a href="#first-steps">5.2. Первые шаги</a></li><li><a href="#inverse-approach">5.3. Инверсия</a></li><li><a href="#java-edition">5.4. Версия на Java</a></li><li><a href="#liberty-way">5.5. Liberty-Way</a></li><li><a href="#communication-with-the-drone">5.6. Связь с дроном</a></li><li><a href="#camera-gimbal">5.7. Подвес для камеры</a></li></ul></li><li><a href="#eitude-amls-platform">6. Платформа Eitude</a><ul><li><a href="#grabbing-system">6.1. Система захватов</a></li><li><a href="#weather-protection-system">6.2. Крыша</a></li><li><a href="#platform-speedometer">6.3. Спидометр</a></li><li><a href="#platform-light-sensor">6.4. Датчики уровня освещённости</a></li></ul></li><li><a href="#conclusion">7. Заключение</a></li></ul><hr><h2 id="how-it-works" tabindex="-1"><a class="header-anchor" href="#how-it-works" aria-hidden="true">#</a> 0. Как это работает?</h2><p>Система состоит из двух частей:</p><ul><li><p>Дрона</p><p><img src="/clover-vuepress/assets/liberty-x_side_cutout_2_small.97777a77.png" alt="Liberty-X" title="Liberty-X"></p></li><li><p>И платформы, или подвижной (на автомобиле), или статичной (на постамате)</p><p><img src="/clover-vuepress/assets/platform_side_transparent.9dc49b02.png" alt="Platform" title="Platform"></p></li></ul><p>Порядок действий выглядит так:</p><ul><li>В начале, дрон с посылкой находится далеко от платформы. По сотовой связи или другому радиоканалу, ему отправляются GPS координаты платформы (на дроне установлен модуль Liberty-Link, способный корректировать его положение, независимо от прошивки полётного контроллера. (Модуль ставится в разрыв линии от приёмника (пульта) до полётника).</li><li>Дрон летит на эти координаты. В процессе полёта они могут обновляться (но не часто, чтобы не нагружать канал).</li><li>Когда дрон подлетает близко к платформе, включается стабилизация по GPS. Тут уже данные передаются по ближней радиосвязи и с большой частотой, чтобы дрон успевал за платформой.</li><li>Вместе с этим, происходит снижение дрона (на платформе и дроне есть барометры). Снижение происходит до высоты 1.5-2 метра над платформой.</li><li>В момент снижения включается оптическая (прецизионная) стабилизация с платформы. Как только камера увидит метку, алгоритм &quot;захватит&quot; дрон.</li><li>После включения оптической стабилизации, GPS отходит на второй план и является страхующим (на случай, если что-то пойдёт не так, снова включается GPS стабилизация).</li><li>Во время оптической стабилизации на дроне закреплена ArUco метка, которую видит камера на платформе и по ближней радиосвязи посылает на дрон корректирующие значения.</li><li>Одновременно с оптической стабилизацией включается и посадка. Этот алгоритм искусственно плавно снижает setpoint по высоте (Z) до некоторого порога.</li><li>Как только снижение достигло нужного значения, подаётся команда на платформу для активации механических захватов, которые должны поймать дрон.</li><li>После поимки дрона, происходит его обслуживание, разгрузка посылки и закрытие крыши над платформой (для защиты от неблагоприятных погодных условий).</li><li>На этом посадка завершена!</li></ul><h3 id="short-video-about-our-project-clickable" tabindex="-1"><a class="header-anchor" href="#short-video-about-our-project-clickable" aria-hidden="true">#</a> Видео про наш проект (кликабельно)</h3><iframe width="560" height="315" src="https://www.youtube.com/embed/6qjS-iq6a3k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><hr><h2 id="hold-and-flight-to-waypoints-functions" tabindex="-1"><a class="header-anchor" href="#hold-and-flight-to-waypoints-functions" aria-hidden="true">#</a> 1. Удержание по GPS и полёт по точкам</h2><p>Как уже было сказано ранее, на дроне установлен &quot;универсальный&quot; модуль Liberty-Link, принимающий команды с платформы и корректирующий положение дрона, вмешиваясь в сигнал с пульта управления (подробнее об этом в следующих пунктах).</p><p>В Liberty-Link будет встроенный GPS модуль, и, соответственно, возможность поддержания положения по GPS и следования по точкам. Результат работы алгоритма поддержания позиции по GPS (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/x364giIt6lc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>GPS-модуль будет использоваться из семейства UBlox (например, UBlox Neo-M8). Установлено будет 1 или 3 (для минимизации погрешности) модуля.</p><p><img src="/clover-vuepress/assets/liberty-x_front_cutout_2_small_gps.51f5c6c5.png" alt="GPS Module" title="GPS Module"></p><p>Модули работают по UART-интерфейсу. Настроены на частоту отправки 5 раз в секунду. Прошивка Liberty-Link будет читать данные с модулей и вычислять координаты текущего положения.</p><h3 id="serial-reading" tabindex="-1"><a class="header-anchor" href="#serial-reading" aria-hidden="true">#</a> 1.1. Чтение данных из UART</h3><p>Чтение данных с модуля в буфер выглядит так:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token comment">// Read data from the GPS module</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>GPS_serial<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> new_line_found <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// Stay in this loop as long as there is serial information from the GPS available</span>
	<span class="token keyword">char</span> read_serial_byte <span class="token operator">=</span> GPS_serial<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>read_serial_byte <span class="token operator">==</span> <span class="token char">&#39;$&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Clear the old data from the incoming buffer array if the new byte equals a $ character</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>message_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> message_counter <span class="token operator">&lt;=</span> <span class="token number">99</span><span class="token punctuation">;</span> message_counter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			incoming_message<span class="token punctuation">[</span>message_counter<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;-&#39;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// Reset the message_counter variable because we want to start writing at the begin of the array</span>
		message_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// If the received byte does not equal a $ character, increase the message_counter variable</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>message_counter <span class="token operator">&lt;=</span> <span class="token number">99</span><span class="token punctuation">)</span>
		message_counter<span class="token operator">++</span><span class="token punctuation">;</span>

	<span class="token comment">// Write the new received byte to the new position in the incoming_message array</span>
	incoming_message<span class="token punctuation">[</span>message_counter<span class="token punctuation">]</span> <span class="token operator">=</span> read_serial_byte<span class="token punctuation">;</span>

	<span class="token comment">// Every NMEA line end with a &#39;*&#39;. If this character is detected the new_line_found variable is set to 1</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>read_serial_byte <span class="token operator">==</span> <span class="token char">&#39;*&#39;</span><span class="token punctuation">)</span> new_line_found <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ublox-parsing" tabindex="-1"><a class="header-anchor" href="#ublox-parsing" aria-hidden="true">#</a> 1.2. Парсинг протокола UBlox</h3><p>После, из заполненного буфера вычисляются широта, долгота, тип корректировки (2D, 3D) и количество спутников. Парсинг GPS данных протокола UBlox выглядит так:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token comment">// If the software has detected a new NMEA line it will check if it&#39;s a valid line that can be used</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>new_line_found <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// Reset the new_line_found variable for the next line</span>
	new_line_found <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;L&#39;</span> <span class="token operator">&amp;&amp;</span> incoming_message<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;L&#39;</span> <span class="token operator">&amp;&amp;</span> incoming_message<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;,&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// When there is no GPS fix or latitude/longitude information available</span>
		<span class="token comment">// Set some variables to 0 if no valid information is found by the GPS module. This is needed for GPS lost when flying</span>
		l_lat_gps <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		l_lon_gps <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		lat_gps_previous <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		lon_gps_previous <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		number_used_sats <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// If the line starts with GA and if there is a GPS fix we can scan the line for the latitude, longitude and number of satellites</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;G&#39;</span> <span class="token operator">&amp;&amp;</span> incoming_message<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;A&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;1&#39;</span> <span class="token operator">||</span> incoming_message<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Filter the minutes for the GGA line multiplied by 10</span>
		lat_gps_actual <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1000000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token comment">// To convert the minutes to degrees we need to divide the minutes by 6</span>
		lat_gps_actual <span class="token operator">/=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">6</span><span class="token punctuation">;</span>
		<span class="token comment">// Add the degrees multiplied by 10</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100000000</span><span class="token punctuation">;</span>
		lat_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000000</span><span class="token punctuation">;</span>
		<span class="token comment">// Divide everything by 10</span>
		lat_gps_actual <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>

		<span class="token comment">// Filter the minutes for the GGA line multiplied by 10</span>
		lon_gps_actual <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1000000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token comment">// To convert the minutes to degrees we need to divide the minutes by 6</span>
		lon_gps_actual <span class="token operator">/=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">6</span><span class="token punctuation">;</span>
		<span class="token comment">// Add the degrees multiplied by 10</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1000000000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">100000000</span><span class="token punctuation">;</span>
		lon_gps_actual <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10000000</span><span class="token punctuation">;</span>
		<span class="token comment">// Divide everything by 10</span>
		lon_gps_actual <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;N&#39;</span><span class="token punctuation">)</span>
			<span class="token comment">// When flying north of the equator the latitude_north variable will be set to 1</span>
			latitude_north <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			<span class="token comment">// When flying south of the equator the latitude_north variable will be set to 0</span>
			latitude_north <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;E&#39;</span><span class="token punctuation">)</span>
			<span class="token comment">// When flying east of the prime meridian the longiude_east variable will be set to 1</span>
			longiude_east <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			<span class="token comment">// When flying west of the prime meridian the longiude_east variable will be set to 0</span>
			longiude_east <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token comment">// Filter the number of satillites from the GGA line</span>
		number_used_sats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">10</span><span class="token punctuation">;</span>
		number_used_sats <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>lat_gps_previous <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> lon_gps_previous <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// If this is the first time the GPS code is used</span>
			<span class="token comment">// Set the lat_gps_previous variable to the lat_gps_actual variable</span>
			lat_gps_previous <span class="token operator">=</span> lat_gps_actual<span class="token punctuation">;</span>
			<span class="token comment">// Set the lon_gps_previous variable to the lon_gps_actual variable</span>
			lon_gps_previous <span class="token operator">=</span> lon_gps_actual<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Divide the difference between the new and previous latitude by ten</span>
		lat_gps_loop_add <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>lat_gps_actual <span class="token operator">-</span> lat_gps_previous<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">;</span>
		<span class="token comment">// Divide the difference between the new and previous longitude by ten</span>
		lon_gps_loop_add <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>lon_gps_actual <span class="token operator">-</span> lon_gps_previous<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">;</span>

		<span class="token comment">// Set the l_lat_gps variable to the previous latitude value</span>
		l_lat_gps <span class="token operator">=</span> lat_gps_previous<span class="token punctuation">;</span>
		<span class="token comment">// Set the l_lon_gps variable to the previous longitude value</span>
		l_lon_gps <span class="token operator">=</span> lon_gps_previous<span class="token punctuation">;</span>

		<span class="token comment">// Remember the new latitude value in the lat_gps_previous variable for the next loop</span>
		lat_gps_previous <span class="token operator">=</span> lat_gps_actual<span class="token punctuation">;</span>
		<span class="token comment">// Remember the new longitude value in the lat_gps_previous variable for the next loop</span>
		lon_gps_previous <span class="token operator">=</span> lon_gps_actual<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// If the line starts with SA and if there is a GPS fix we can scan the line for the fix type (none, 2D or 3D)</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>incoming_message<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;S&#39;</span> <span class="token operator">&amp;&amp;</span> incoming_message<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;A&#39;</span><span class="token punctuation">)</span>
		fix_type <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>incoming_message<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="set-current-waypoint" tabindex="-1"><a class="header-anchor" href="#set-current-waypoint" aria-hidden="true">#</a> 1.3. Установка текущей путевой точки</h3><p>Далее, с полученными данными и происходит самая магия. Для включения поддержания текущего положения достаточно установить флаг <code>waypoint_set = 1;</code> и установить текущие координаты как waypoint:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code>l_lat_waypoint <span class="token operator">=</span> l_lat_gps<span class="token punctuation">;</span>
l_lon_waypoint <span class="token operator">=</span> l_lon_gps<span class="token punctuation">;</span>
</code></pre></div><p>После этого, начнётся вычисление ошибки в координатах и корректировка с помощью PD - регулятора. Для D - составляющей используется rotation memory.</p><p><a name="14-waypoint-edit-to-fly-to-waypoints"></a></p><h3 id="waypoint-edit-to-fly-to-waypoints" tabindex="-1"><a class="header-anchor" href="#waypoint-edit-to-fly-to-waypoints" aria-hidden="true">#</a> 1.4. Изменение точек (Чтобы летать по координатам)</h3><p>Если просто задать новые <code>l_lat_waypoint</code> и <code>l_lon_wayoint</code>, находящиеся на большом удалении от дрона, он не сможет нормально прилететь и стабилизироваться на этих координатах. Для плавного изменения можно использовать переменные <code>l_lat_gps_float_adjust</code> и <code>l_lon_gps_float_adjust</code>. Это переменные типа <code>float</code>, изменяя которые, <code>l_lat_waypoint</code> и <code>l_lon_waypoint</code> будут плавно меняться.</p><p>Например, если в основном цикле постоянно прибавлять некую величину к этим переменным:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code>l_lat_gps_float_adjust <span class="token operator">+=</span> <span class="token number">0.0015</span><span class="token punctuation">;</span>
</code></pre></div><p>При установленном waypoint, дрон будет плавно перемещаться в заданном направлении. В дальнейшим это будет использоваться для плавного ускорения и замедления во время движения к точке.</p><h3 id="waypoint-stabilization" tabindex="-1"><a class="header-anchor" href="#waypoint-stabilization" aria-hidden="true">#</a> 1.5. Удержание конкретной позиции</h3><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>waypoint_set <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//If the waypoints are stored</span>

	<span class="token comment">// Adjust l_lat_waypoint</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>l_lat_gps_float_adjust <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		l_lat_waypoint<span class="token operator">++</span><span class="token punctuation">;</span>
		l_lat_gps_float_adjust<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>l_lat_gps_float_adjust <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		l_lat_waypoint<span class="token operator">--</span><span class="token punctuation">;</span>
		l_lat_gps_float_adjust<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Adjust l_lon_waypoint</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>l_lon_gps_float_adjust <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		l_lon_waypoint<span class="token operator">++</span><span class="token punctuation">;</span>
		l_lon_gps_float_adjust<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>l_lon_gps_float_adjust <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		l_lon_waypoint<span class="token operator">--</span><span class="token punctuation">;</span>
		l_lon_gps_float_adjust<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Calculate the latitude error between waypoint and actual position</span>
	gps_lon_error <span class="token operator">=</span> l_lon_waypoint <span class="token operator">-</span> l_lon_gps<span class="token punctuation">;</span>
	<span class="token comment">// Calculate the longitude error between waypoint and actual position</span>
	gps_lat_error <span class="token operator">=</span> l_lat_gps <span class="token operator">-</span> l_lat_waypoint<span class="token punctuation">;</span>

	<span class="token comment">// Subtract the current memory position to make room for the new value</span>
	gps_lat_total_average <span class="token operator">-=</span> gps_lat_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">// Calculate the new change between the actual pressure and the previous measurement</span>
	gps_lat_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span> <span class="token operator">=</span> gps_lat_error <span class="token operator">-</span> gps_lat_error_previous<span class="token punctuation">;</span>
	<span class="token comment">// Add the new value to the long term average value</span>
	gps_lat_total_average <span class="token operator">+=</span> gps_lat_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// Subtract the current memory position to make room for the new value</span>
	gps_lon_total_average <span class="token operator">-=</span> gps_lon_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">// Calculate the new change between the actual pressure and the previous measurement</span>
	gps_lon_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span> <span class="token operator">=</span> gps_lon_error <span class="token operator">-</span> gps_lon_error_previous<span class="token punctuation">;</span>
	<span class="token comment">// Add the new value to the long term average value</span>
	gps_lon_total_average <span class="token operator">+=</span> gps_lon_rotating_mem<span class="token punctuation">[</span>gps_rotating_mem_location<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// Increase the rotating memory location</span>
	gps_rotating_mem_location<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_rotating_mem_location <span class="token operator">==</span> <span class="token number">35</span><span class="token punctuation">)</span>
		<span class="token comment">// Start at 0 when the memory location 35 is reached</span>
		gps_rotating_mem_location <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">// Remember the error for the next loop</span>
	gps_lat_error_previous <span class="token operator">=</span> gps_lat_error<span class="token punctuation">;</span>
	gps_lon_error_previous <span class="token operator">=</span> gps_lon_error<span class="token punctuation">;</span>

	<span class="token comment">//Calculate the GPS pitch and roll correction as if the nose of the multicopter is facing north.</span>
	<span class="token comment">//The Proportional part = (float)gps_lat_error * gps_p_gain.</span>
	<span class="token comment">//The Derivative part = (float)gps_lat_total_average * gps_d_gain.</span>
	gps_pitch_adjust_north <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_lat_error <span class="token operator">*</span> gps_p_gain <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_lat_total_average <span class="token operator">*</span> gps_d_gain<span class="token punctuation">;</span>
	gps_roll_adjust_north <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_lon_error <span class="token operator">*</span> gps_p_gain <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_lon_total_average <span class="token operator">*</span> gps_d_gain<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>latitude_north<span class="token punctuation">)</span>
		<span class="token comment">// Invert the pitch adjustmet because the quadcopter is flying south of the equator</span>
		gps_pitch_adjust_north <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>longiude_east<span class="token punctuation">)</span>
		<span class="token comment">// Invert the roll adjustmet because the quadcopter is flying west of the prime meridian</span>
		gps_roll_adjust_north <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

	<span class="token comment">//Because the correction is calculated as if the nose was facing north, we need to convert it for the current heading.</span>
	gps_roll_adjust <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_roll_adjust_north <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>angle_yaw <span class="token operator">*</span> <span class="token number">0.017453</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_pitch_adjust_north <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span>angle_yaw <span class="token operator">-</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.017453</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	gps_pitch_adjust <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_pitch_adjust_north <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>angle_yaw <span class="token operator">*</span> <span class="token number">0.017453</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>gps_roll_adjust_north <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span>angle_yaw <span class="token operator">+</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.017453</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//Limit the maximum correction to 300. This way we still have full control with the pitch and roll stick on the transmitter.</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_roll_adjust <span class="token operator">&gt;</span> <span class="token number">300</span><span class="token punctuation">)</span> gps_roll_adjust <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_roll_adjust <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">)</span> gps_roll_adjust <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_pitch_adjust <span class="token operator">&gt;</span> <span class="token number">300</span><span class="token punctuation">)</span> gps_pitch_adjust <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_pitch_adjust <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">)</span> gps_pitch_adjust <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="following" tabindex="-1"><a class="header-anchor" href="#following" aria-hidden="true">#</a> 2. Следование за платформой</h2><p>Основной задачей стабилизации по GPS-координатам стала разработка алгоритма предсказания положения дрона. Самым простым способом представилось использовать математический расчет следующего положения дрона. Это вычисляется для наиболее точного позиционирования дрона в отношении посадочной платформы.</p><p>Для начала был придуман простейший алгоритм расчета коэффициента изменения координат. Реализация производилась на языке Python. На этапе тестирования данного алгоритма встала проблема симуляции генерации GPS-координат. Дабы разрешить эту проблему, было испробовано много различных ресурсов: от открытых исходных кодов самодельных навигаторов до попытки использовать API Google Maps, Yandex Maps или 2GIS. И лишь спустя семестр мы додумались до простого изменения значений по некоторой дельте с отрисовкой в MatPlotLib либо PyQtGraph. До этого всё тестирование алгоритма производилось с использованием инструментария прошивки PX4, симулятора движения дрона Gazebo. Как следствие было преодолено много формальностей в вопросах общения с симулятором и увеличением производительности.</p><p>Видео работы алгоритма предсказания GPS координат (кликабельно)</p><iframe width="560" height="315" src="https://www.youtube.com/embed/Rg-Y_fl4BKQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Конечный результат ошибки предсказанных координат достиг диапазона от 0 до 70 см.</p><hr><p><a name="3-compass"></a></p><h2 id="compass" tabindex="-1"><a class="header-anchor" href="#compass" aria-hidden="true">#</a> 3. Компас</h2><p>До момента оптической стабилизации (во время GPS стабилизации), для вычисления вектора корректировки по GPS требуется знать точный угол по компасу. Для этого используется встроенный в GPS модуль компас.</p><p>Т.к. во время полёта меняются углы крена и тангажа, требуется корректировать значения с компаса. В общем плане, вычисления угла с комапса выглядит так:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token comment">// The compass values change when the roll and pitch angle of the quadcopter changes. That&#39;s the reason that the x and y values need to calculated for a virtual horizontal position</span>
<span class="token comment">// The 0.0174533 value is phi/180 as the functions are in radians in stead of degrees</span>
compass_x_horizontal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>compass_x <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>angle_pitch <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0174533</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>compass_y <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>angle_roll <span class="token operator">*</span> <span class="token number">0.0174533</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>angle_pitch <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0174533</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>compass_z <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>angle_roll <span class="token operator">*</span> <span class="token number">0.0174533</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>angle_pitch <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0174533</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
compass_y_horizontal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>compass_y <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>angle_roll <span class="token operator">*</span> <span class="token number">0.0174533</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>compass_z <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>angle_roll <span class="token operator">*</span> <span class="token number">0.0174533</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Now that the horizontal values are known the heading can be calculated. With the following lines of code the heading is calculated in degrees.</span>
<span class="token comment">// Please note that the atan2 uses radians in stead of degrees. That is why the 180/3.14 is used.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>compass_y_horizontal <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>actual_compass_heading <span class="token operator">=</span> <span class="token number">180</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">180</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">atan2</span><span class="token punctuation">(</span>compass_y_horizontal<span class="token punctuation">,</span> compass_x_horizontal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">180</span> <span class="token operator">/</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> actual_compass_heading <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">atan2</span><span class="token punctuation">(</span>compass_y_horizontal<span class="token punctuation">,</span> compass_x_horizontal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">180</span> <span class="token operator">/</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add the declination to the magnetic compass heading to get the geographic north</span>
actual_compass_heading <span class="token operator">+=</span> declination<span class="token punctuation">;</span>
<span class="token comment">// If the compass heading becomes smaller then 0, 360 is added to keep it in the 0 till 360 degrees range</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>actual_compass_heading <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> actual_compass_heading <span class="token operator">+=</span> <span class="token number">360</span><span class="token punctuation">;</span>
<span class="token comment">// If the compass heading becomes larger then 360, 360 is subtracted to keep it in the 0 till 360 degrees range</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>actual_compass_heading <span class="token operator">&gt;=</span> <span class="token number">360</span><span class="token punctuation">)</span> actual_compass_heading <span class="token operator">-=</span> <span class="token number">360</span><span class="token punctuation">;</span>
</code></pre></div><p>Понятно, что угол с компаса можно использовать и для поддержания угла рыскания дрона в целом. При полётах по точкам это, возможно, будет реализовано. Но данный момент, острой необходимости в этом нет, т.к. после начала оптической стабилизации, её алгоритм способен корректировать дрон независимо от его угла рыскания. Также, во время оптической стабилизации угол автоматически корректируется.</p><hr><h2 id="altitude-stabilization-barometer" tabindex="-1"><a class="header-anchor" href="#altitude-stabilization-barometer" aria-hidden="true">#</a> 4. Удержание высоты (барометр)</h2><p>До момента оптической стабилизации (во время GPS стабилизации), наш модуль Liberty-Link будет иметь возможность поддержания высоты при помощи барометра.</p><p>На платформе, так же, как и в Liberty-Link будут установлены следующие барометры MS5611.</p><p><img src="/clover-vuepress/assets/ms5611_barometer.cbd68a83.png" alt="MS5611" title="MS5611"></p><p>Согласно документации, разрешение по высоте составляет 10см. Алгоритм будет брать значения давления и, пропуская его через ПИД-регулятор, стабилизировать высоту дрона, изменяя Throttle (3-ий канал).</p><p>Видео работы алгоритма удержания высоты по барометру (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/xmvcGeZzEfc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Во время полёта по точкам, setpoint давления будет уменьшаться, для повышения высоты (лететь по прямой безопаснее на большой высоте, чтобы ни во что не врезаться). А во время стабилизации по GPS (когда дрон находится уже близко к платформе), дрону будет задан setpoint по давлению такой, чтобы соответствовать ~1.5-2м высоты над платформой.</p><hr><h2 id="optical-stabilization" tabindex="-1"><a class="header-anchor" href="#optical-stabilization" aria-hidden="true">#</a> 5. Оптическая стабилизация</h2><h3 id="so-difficult-and-so-important" tabindex="-1"><a class="header-anchor" href="#so-difficult-and-so-important" aria-hidden="true">#</a> 5.1. Так сложно и так важно</h3><p>Оптическая стабилизация - самая важная и сложная часть нашего проекта. Только благодаря этим алгоритмам в наших условиях возможно достаточно точно удерживать дрон над платформой. Текущая версия алгоритма оптической стабилизации вместе с описанием для повторения, доступна в нашем основном репозитории на GitHub. В дальнейшем, к ней добавится и стабилизация по GPS.</p><h3 id="first-steps" tabindex="-1"><a class="header-anchor" href="#first-steps" aria-hidden="true">#</a> 5.2. Первые шаги</h3><p>Так как мы не знали насколько реальным окажется выполнение этой далеко не простой задачи, первое что мы сделали, это определились, с помощью чего возможно точно стабилизировать дрон в пространстве. И тут, практически единогласно победил вариант с оптической стабилизации при помощи меток дополненной реальности. Во первых, это достаточно бюджетно, не нужны дорогостоящие системы GPS RTK, а, во вторых, дает требуемую точность. Одной из самых первых идей - было приделать Raspberry Pi к дрону, как это сделано на платформе Клевер, и стабилизироваться по метке на платформе.</p><p>Тест прототипа первой оптической стабилизации (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/TrrxXOHAqbQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Но, проведя пару тестов от этой идеи мы быстро отказались. Для начала, Raspberry Pi очень слабая для быстрого вычисления такого объема данных, во вторых, сама идея установки на каждый дрон компьютера выглядит нерациональной.</p><p>Также, у нас были промежуточные прототипы, например, попытки использовать цветовые маркеры (окружности различных цветов), но эти идеи не оказались достаточно работоспособными.</p><h3 id="inverse-approach" tabindex="-1"><a class="header-anchor" href="#inverse-approach" aria-hidden="true">#</a> 5.3. Инверсия</h3><p>Так мы и пришли к текущему виду оптической стабилизации, когда камера с мощным компьютером расположены на платформе, а на дроне лишь ArUco 4x4 метка и модуль, управляющий им.</p><p>Самые первые тесты, в этом примере даже нет оценки положения маркера (pose estimation)(кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/A2oq6zCebVo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Далее, были внедрены алгоритмы Pose Estimation благодаря библиотеке OpenCV. Первые тесты показали что мы на верном пути!</p><p>Pose Estimation Pyhton (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/kE3UmJZ00so" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Но, по прежнему, алгоритмы были далеки от идеала. Например, т.к. код писался на Python (<a href="https://github.com/XxOinvizioNxX/Liberty-X_Point" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Liberty-X_Point<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>), производительность была не велика, также, не было нормального контроля потоков. Поэтому, пришлось что-то менять.</p><h3 id="java-edition" tabindex="-1"><a class="header-anchor" href="#java-edition" aria-hidden="true">#</a> 5.4. Версия на Java</h3><p>Взвесив все ЗА и ПРОТИВ, было решено переписать всю оптическую стабилизацию на Java. Так и появилась первая версия Liberty-Way. На этот раз было решено подойти к ООП основательно, и, после небольшой настройки получился отличный алгоритм стабилизации и посадки.</p><p>Тест посадки на Liberty-Way v.beta_0.0.1 (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/8VAobWPFG8g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h3 id="liberty-way" tabindex="-1"><a class="header-anchor" href="#liberty-way" aria-hidden="true">#</a> 5.5. Liberty-Way</h3><p>Далее последовало много доработок и исправлений ошибок. В результате, Liberty-Way представляет собой кроссплатформенное приложение, управляющееся через веб сарвар, что очень удобно для настройки и отладки. Также, в последних версиях (beta_1.0.3 - beta_1.1.2) был внедрён blackbox (для записи логов), а также общение с платформой и много других необходимых алгоритмов.</p><p>Полное описание, включая все настройки, запуск и т.д. вы можете найти в нашем репозитории на GitHub: <a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Liberty-Way<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>Видео работы статичной стабилизации (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/adR38R27MEU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Liberty-Way может даже стабилизировать &quot;брошенный&quot; дрон (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/gAaGQSC-r2g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Да, на видео есть небольшой баг с поворотом, в новом релизе он исправлен</p><p>И, конечно же, работа в движении (тестировалось ещё на beta_0.0.3)(кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/8vB-8QIBoJU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Все основные настройки удобно вынесены в отельный JSON-файлы (settings, PID), что позволяет без пересборки приложения быстро менять нужные параметры. Фактически, для запуска приложения, достаточно скачать последний релиз, распаковать архив и запустить через соответствующий вашей ОС лаунчер.</p><h3 id="communication-with-the-drone" tabindex="-1"><a class="header-anchor" href="#communication-with-the-drone" aria-hidden="true">#</a> 5.6. Связь с дроном</h3><p>Liberty-Way подключается к модулю Liberty-Link, установленному на дроне, и, корректирует его положение, управляя напрямую первыми четырьмя основными каналами пульта. За один цикл (каждый фрейм с камеры) на модуль отправляются 12 байт данных корректировки: <img src="/clover-vuepress/assets/data_structure.5198548c.png" alt="Packet" title="Data packet"></p><ul><li><strong>Roll bytes</strong> - Корректировка крена (1000-2000)</li><li><strong>Pitch bytes</strong> - Корректировка тангажа (1000-2000)</li><li><strong>Yaw bytes</strong> - Корректировка рыскания (1000-2000)</li><li><strong>Altitude bytes</strong> - Корректировка газа (высоты)</li><li><strong>Service info</strong> - Состояние дрона (0 - Корректировка отключена, 1 - Стабилизация, 2 - Снижение по барометру (команда не внедрена), 3 - Отключение моторов)</li><li><strong>Check byte</strong> - XOR чек-сумма</li><li><strong>Data suffix</strong> - уникальная пара ASCII символов, чтобы обозначить конец пакета</li></ul><p>На стороне дрона (модуля Liberty-Link), чтение данных происходит следующим образом:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>Telemetry_serial<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	tdc_receive_buffer<span class="token punctuation">[</span>tdc_receive_buffer_counter<span class="token punctuation">]</span> <span class="token operator">=</span> Telemetry_serial<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tdc_receive_byte_previous <span class="token operator">==</span> <span class="token char">&#39;L&#39;</span> <span class="token operator">&amp;&amp;</span> tdc_receive_buffer<span class="token punctuation">[</span>tdc_receive_buffer_counter<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">&#39;X&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		tdc_receive_buffer_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tdc_receive_start_detect <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			tdc_check_byte <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>tdc_temp_byte <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> tdc_temp_byte <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">;</span> tdc_temp_byte<span class="token operator">++</span><span class="token punctuation">)</span>
				tdc_check_byte <span class="token operator">^=</span> tdc_receive_buffer<span class="token punctuation">[</span>tdc_temp_byte<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>tdc_check_byte <span class="token operator">==</span> tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				direct_roll_control <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
				direct_pitch_control <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
				direct_yaw_control <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
				direct_throttle_control <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
				direct_service_info <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>tdc_receive_buffer<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>direct_roll_control <span class="token operator">&gt;</span> <span class="token number">1100</span> <span class="token operator">&amp;&amp;</span> direct_roll_control <span class="token operator">&lt;</span> <span class="token number">1900</span> <span class="token operator">&amp;&amp;</span>
					direct_pitch_control <span class="token operator">&gt;</span> <span class="token number">1100</span> <span class="token operator">&amp;&amp;</span> direct_pitch_control <span class="token operator">&lt;</span> <span class="token number">1900</span> <span class="token operator">&amp;&amp;</span>
					direct_yaw_control <span class="token operator">&gt;</span> <span class="token number">1100</span> <span class="token operator">&amp;&amp;</span> direct_yaw_control <span class="token operator">&lt;</span> <span class="token number">1900</span> <span class="token operator">&amp;&amp;</span>
					direct_throttle_control <span class="token operator">&gt;</span> <span class="token number">1100</span> <span class="token operator">&amp;&amp;</span> direct_throttle_control <span class="token operator">&lt;</span> <span class="token number">1900</span> <span class="token operator">&amp;&amp;</span>
					<span class="token comment">/*flight_mode == 2 &amp;&amp;*/</span> channel_7 <span class="token operator">&gt;</span> <span class="token number">1500</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					tdc_timer <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					tdc_working <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span>
					tdc_working <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				direct_roll_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
				direct_pitch_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
				tdc_working <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span>
			tdc_receive_start_detect<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token punctuation">{</span>
		tdc_receive_byte_previous <span class="token operator">=</span> tdc_receive_buffer<span class="token punctuation">[</span>tdc_receive_buffer_counter<span class="token punctuation">]</span><span class="token punctuation">;</span>
		tdc_receive_buffer_counter<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tdc_receive_buffer_counter <span class="token operator">&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span>tdc_receive_buffer_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> tdc_timer <span class="token operator">&gt;=</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	tdc_working <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>tdc_working <span class="token operator">&amp;&amp;</span> direct_service_info <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>return_to_home_step<span class="token punctuation">)</span>
	return_to_home_step <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tdc_working<span class="token punctuation">)</span>
	return_to_home_step <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tdc_working <span class="token operator">||</span> direct_service_info <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	direct_roll_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
	direct_pitch_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
	direct_yaw_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
	direct_throttle_control <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>В результате, имеются 4 переменные:</p><div class="language-text ext-text"><pre class="language-text"><code>direct_roll_control
direct_pitch_control
direct_yaw_control
direct_throttle_control
</code></pre></div><p>Которые напрямую прибавляются к данным, поступающим с пульта управления. Вероятно, в дальнейшем, будут добавлены и другие данные, как минимум, для работы с GPS. Следите за обновлениями в нашем репозитории.</p><h3 id="camera-gimbal" tabindex="-1"><a class="header-anchor" href="#camera-gimbal" aria-hidden="true">#</a> 5.7. Подвес для камеры</h3><p>Для эксплуатации нашей системы в реальных условиях, требуется минимизировать тряску камеры, чтобы не потерять метку на дроне. Для этого, была разработана 3Д-модель крепления подвеса от дрона к нашей платформе для стабилизации обычной веб камеры</p><p>Крепление для камеры:</p><p><img src="/clover-vuepress/assets/gimbal_camera_mount.f4e239ff.png" alt="Camera mount" title="Camera mount"></p><p>Крепление провода (ферритового фильтра на проводе) камеры:</p><p><img src="/clover-vuepress/assets/gimbal_filter_mount.648325eb.png" alt="Filter mount" title="Filter mount"></p><p>Крепление защёлок &quot;крабиков&quot; на подложку подвеса:</p><p><img src="/clover-vuepress/assets/gimbal_plane_mount.7beb93d0.png" alt="Plane mount" title="Plane mount"></p><p>Примерный вид сборки всего механизма подвеса:</p><p><img src="/clover-vuepress/assets/gimbal_assembly.8a3e4f2f.png" alt="Assembly" title="Assembly"></p><hr><h2 id="eitude-amls-platform" tabindex="-1"><a class="header-anchor" href="#eitude-amls-platform" aria-hidden="true">#</a> 6. Платформа Eitude</h2><p>Платформа - взаимосвязанная система для посадки дрона. Управляться платформа планируется через Serial-интерфейс, с помощью G-Code команд: Текущий код платформы можно в репозитории Eitude на GitHub: <a href="https://github.com/XxOinvizioNxX/Eitude" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Eitude<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="grabbing-system" tabindex="-1"><a class="header-anchor" href="#grabbing-system" aria-hidden="true">#</a> 6.1. Система захватов</h3><p>Но ведь логично, что в реальности, без системы захватов невозможно посадить дрон, не повредив никого. Пока что, у нас есть прототип в виде 3Д модели. Для реализации захвата дрона будут изготовлены 4 длинных захвата с крючками на концах и по мере посадки коптера на платформу, шасси будут захватываться этими 4-мя крючками и удерживаться по мере снижения и после него.</p><p><img src="/clover-vuepress/assets/grabbing_system_1.095fdfb2.png" alt="Screenshot" title="Screenshot"></p><p><img src="/clover-vuepress/assets/grabbing_system_2.ef5115eb.png" alt="Screenshot" title="Screenshot"></p><h3 id="weather-protection-system" tabindex="-1"><a class="header-anchor" href="#weather-protection-system" aria-hidden="true">#</a> 6.2. Крыша</h3><p>Для защиты от неблагоприятных погодных условий, мы разработали механизм крыши - ножничные механизмы, обтянутые брезентом, которые находятся на краях платформы и после успешной посадки механизмы с обеих сторон платформы будут закрываться и защищать дрон от внешнего воздействия, Сама конструкция крыши делает её достаточно лёгкой и прочной, а ножничный механизм позволяет просто складывается и раскладывается при этом сборка такого механизма будет простой и надежной.</p><p><img src="/clover-vuepress/assets/platform_side_transparent.9dc49b02.png" alt="Screenshot" title="Screenshot"></p><p><img src="/clover-vuepress/assets/platform_roof.95d0b6eb.png" alt="Screenshot" title="Screenshot"></p><h3 id="platform-speedometer" tabindex="-1"><a class="header-anchor" href="#platform-speedometer" aria-hidden="true">#</a> 6.3. Спидометр</h3><p>Для будущей посадки на быстро движущуюся платформу, очень полезно знать скорость её движения. На данный момент на платформе нет GPS модуля, или иных способов измерить абсолютную скорость. Поэтому, для временного решения этой проблемы, решено было вычислять скорость по ускорению, используя акселерометр. Для примера, MPU6050. IMU-модуль через мягкую подложку установлен на прототип платформы и прикрыт крышкой для защиты от ветра. Алгоритм стабилизации (Liberty-Way) посылает на платформу запрос <code>L1</code> для проверки скорости. В качестве ответа возвращается <code>S0 L&lt;скорость в км/ч&gt;</code>.</p><p><img src="/clover-vuepress/assets/mpu6050_gyro.edd8fb87.png" alt="MPU6050" title="MPU6050"></p><p>Тест спидометра (внутри серого круга нижний правый параметр (SPD) - скорость в км/ч) (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/yvCo6tYjdM0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Для вычисления скорости, берётся ускорение за маленькие промежутки времени, перемножается со временем, получая моментальную скорость. Которая постоянно прибавляется к предыдущей сумме:</p><div class="language-cpp ext-cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">speed_handler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">gyro_signalen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Filter accelerations</span>
	acc_x_filtered <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>acc_x_filtered <span class="token operator">*</span> ACC_FILTER_KOEFF <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>acc_x <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> ACC_FILTER_KOEFF<span class="token punctuation">)</span><span class="token punctuation">;</span>

	speed <span class="token operator">=</span> acc_x_filtered<span class="token punctuation">;</span>
	<span class="token comment">// Convert acceleration to G</span>
	speed <span class="token operator">/=</span> <span class="token number">4096.0</span><span class="token punctuation">;</span>
	<span class="token comment">// Convert to m/s^2</span>
	speed <span class="token operator">*=</span> <span class="token number">9.81</span><span class="token punctuation">;</span>
	<span class="token comment">// Multiply by dt to get instant speed in m/ms</span>
	speed <span class="token operator">*=</span> <span class="token punctuation">(</span><span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> speed_loop_timer<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Reset timer</span>
	speed_loop_timer <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Convert to m/s</span>
	speed <span class="token operator">/=</span> <span class="token number">1000.0</span><span class="token punctuation">;</span>
	<span class="token comment">// Convert to km/h</span>
	speed <span class="token operator">*=</span> <span class="token number">3.6</span><span class="token punctuation">;</span>

	<span class="token comment">// Accumulate instatnt speed</span>
	speed_accumulator <span class="token operator">+=</span> speed<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>in_move_flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// If the platform is not moving, reset the speed</span>
		speed_accumulator <span class="token operator">=</span> speed_accumulator <span class="token operator">*</span> SPEED_ZEROING_FACTOR<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Несмотря на наличие различных фильтров, из-за погрешности скорость может не &quot;вернуться&quot; в 0, поэтому, также производится замер вибраций, и, если они меньше порога, считается что платформа стоит и постепенно обнуляется скорость.</p><p>Полный код спидометра можно найти в репозитории Eitude на GitHub: <a href="https://github.com/XxOinvizioNxX/Eitude" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Eitude<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="platform-light-sensor" tabindex="-1"><a class="header-anchor" href="#platform-light-sensor" aria-hidden="true">#</a> 6.4. Датчики уровня освещённости</h3><p>Т.к. наша платформа должна работать в различных окружающих условиях, а оптическая стабилизация очень требовательна к видимости ArUco маркера, важно иметь автоматическую систему измерения выдержки камеры по уровню освещённости, а, при её нехватке, даже включать дополнительную подсветку. В долгосрочной перспективе в качестве датчиков света планируется использовать специализированные сенсоры, например, BH1750.</p><p>В текущем варианте прототипа, используются 6 светодиодов в качестве датчика света и, встроенный в микроконтроллер, АЦП. Алгоритм стабилизации (Liberty-Way) посылает на платформу запрос <code>L0</code> для проверки уровня освещённости. В качестве ответа возвращается <code>S0 L&lt;освещённость&gt;</code>.</p><p><img src="/clover-vuepress/assets/light_sensors.878ff57e.png" alt="Light sensors" title="Light sensors"></p><p>Тест определения уровня освещённости с помощью светодиодов (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/xQeiA945aRA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Тест регулировки выдержки и включения дополнительной подсветки (кликабельно):</p><iframe width="560" height="315" src="https://www.youtube.com/embed/iMORim6zxsg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion" aria-hidden="true">#</a> 7. Заключение</h2><p>На данный момент, имеется отлаженный прототип оптической стабилизации, GPS удержания, стабилизации высоты по барометру, платформы и множество 3Д-моделей, жаждущих реализации. Проект автоматической посадки дрона на движущуюся платформу ещё не закончен.</p><p>Следите за нашими апдейтами:</p><ul><li>На репозитории GitHub: <a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank" rel="noopener noreferrer">https://github.com/XxOinvizioNxX/Liberty-Way<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</li><li>И на нашем YouTube-канале: <a href="https://www.youtube.com/channel/UCqN12Jzy-1eJLkcA32R0jdg" target="_blank" rel="noopener noreferrer">https://www.youtube.com/channel/UCqN12Jzy-1eJLkcA32R0jdg<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</li></ul><p>В дальнейшем, мы планируем сделать ещё много нового и интересного!</p><p><img src="/clover-vuepress/assets/follow_the_white_rabbit.d964d129.png" alt="Follow the white rabbit" title="Follow the white rabbit"></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/CopterExpress/clover/edit/master/docs/ru/amls.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/clover-vuepress/ru/lane_control.html" class="" aria-label="Контроль соблюдения ПДД на выделенной полосе с дроном"><!--[--><!--]--> Контроль соблюдения ПДД на выделенной полосе с дроном <!--[--><!--]--></a></span><span class="next"><a href="/clover-vuepress/ru/remote-control-with-oculusvr.html" class="" aria-label="Разработка системы для управления БПЛА с помощью шлема виртуальной реальности"><!--[--><!--]--> Разработка системы для управления БПЛА с помощью шлема виртуальной реальности <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/clover-vuepress/assets/app.4f6a4bec.js" defer></script>
  </body>
</html>
